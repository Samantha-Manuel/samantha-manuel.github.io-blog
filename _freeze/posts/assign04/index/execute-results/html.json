{
  "hash": "f2761f78f057f7ffa5e25988d9ab87a1",
  "result": {
    "markdown": "---\ntitle: \"EPPS 6356 Assignment 4\"\nauthor: \"Samantha Manuel\"\ndate: \"2022-10-4\"\ncategories: [EPPS6356, Assignments]\nimage: \"HW4agg.jpg\"\n---\n\n\nLet's do a Hackathon and generate charts!\n\nA designer is trained through repetitive practices and creating multiple works on the same object. This assignment follows that method and requests doing charts via a programming approach. Let's do a hackathon and generate charts in the next 24 hours. Generate a program to create a chart using either R Graphics or ggplot2 or any R packages (no other methods/software are allowed).\n\nThe data set used aimed to observe the net domestic immigration rates (NDIR), which represents the net movement of people into and out of a state, over the period 1990-1994 divided by the population of the state. Alaska and Hawaii are excluded from the analysis because the environments of these states are significantly different from the other 48, and their locations present certain barriers to immigration. Eleven predictor variables thought to influence NDIR are defined in Table 1.4 below.\n\n![](images/Table%201.4.jpg){fig-align=\"center\" width=\"720\"}\n\nIndependent Variable (IV): Regional Tax Brackets\n\nDependent Variable (DV): NDIR (Net Domestic Immigration Rate)\n\nLegend of Dummy DV (NDIR):\n\nImmigration into the Region - \"1\"\n\nEmigration out of the Region - \"0\"\n\nBelow is our analysis of our generated charts:\n\n![](images/HW4tax-NDIR.jpg){fig-align=\"center\" width=\"594\"}\n\nFigure 1: The Effect of Tax Brackets on NDIR.\n\nThe first and second tax bracket shows a higher number of people immigrating in this tax bracket than emigrating. However, the third and fourth tax brackets have lower immigration rates than emigration rates. This shows there is no general trend of NDIR in relation to all four tax brackets, as seen in Figure 1.\n\nWhat can be observed is that the lower the value of NDIR, the more people are emigrating out of the state, the higher the value of NDIR, the more people are immigrating into the state.\n\n![](images/HW4region-NDIR.jpg){fig-align=\"center\" width=\"607\"}\n\nFigure 2: The Effect of Region on NDIR.\n\n![](images/HW4tax-region.jpg){fig-align=\"center\" width=\"623\"}\n\nFigure 3: The Effect of Region on Tax Brackets.\n\nThe immigration/emigration graph organized by region, suggests that people in the Northeast region almost exclusively emigrate, as seen in Figures 2 and 3 above. The effects of region on tax bracket model shows that none of the participants responded that they belonged in either of the first two tax brackets. This could also be the reason that we do not see Northeast noticeably represented in the aggregated model, Figure 4.\n\n![](images/HW4agg.jpg){fig-align=\"center\"}\n\nFigure 4: The Effect of Tax Brackets on NDIR by Region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setting up the new R environment, starting fresh, click run! \n(list=ls())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncharacter(0)\n```\n:::\n\n```{.r .cell-code}\n# Setting up the working directory, click run!\nsetwd(\"/Users/sami_manuel/Documents/Fall 2022/EPPS 6356/samantha-manuel.github.io\")\n\n# Reading the file, click run!\nHW4 <- read.delim(\"HW4data.txt\") \nhead(HW4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        State   NDIR Unemp  Wage Crime Income Metrop Poor Taxes Educ BusFail\n1     Alabama  17.47   6.0 10.75   780  27196   67.4 16.4  1553 66.9    0.20\n2     Arizona  49.60   6.4 11.17   715  31293   84.7 15.9  2122 78.7    0.51\n3    Arkansas  23.62   5.3  9.65   593  25565   44.7 15.3  1590 66.3    0.08\n4  California -37.21   8.6 12.44  1078  35331   96.7 17.9  2396 76.2    0.63\n5    Colorado  53.17   4.2 12.27   567  37833   81.8  9.0  2092 84.4    0.42\n6 Connecticut -38.41   5.6 13.53   456  41097   95.7 10.8  3334 79.2    0.33\n   Temp    Region\n1 62.77     South\n2 61.09      West\n3 59.57     South\n4 59.25      West\n5 43.43      West\n6 48.63 Northeast\n```\n:::\n\n```{.r .cell-code}\n#Turning on the packages required for HW4, click run!\nlibrary(\"Hmisc\") \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: survival\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Formula\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Hmisc'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    format.pval, units\n```\n:::\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✓ tibble  3.1.6     ✓ dplyr   1.0.8\n✓ tidyr   1.2.0     ✓ stringr 1.4.0\n✓ readr   2.1.1     ✓ forcats 0.5.1\n✓ purrr   0.3.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\nx dplyr::filter()    masks stats::filter()\nx dplyr::lag()       masks stats::lag()\nx dplyr::src()       masks Hmisc::src()\nx dplyr::summarize() masks Hmisc::summarize()\n```\n:::\n\n```{.r .cell-code}\n#Identifying the mean of HW4 for later usage: mean= 10.88854, click run!\nmean(HW4$NDIR)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 10.88854\n```\n:::\n\n```{.r .cell-code}\n#Creating a new dummy variable, i.e. above 1 or below 0 mean, click run!\nHW4$NDIR_dummy <- ifelse(HW4$NDIR>=10.88854, 1, 0)\n\n#Creating taxes into an ordinal variable with 4 equally sized bins, click run!\nHW4$tax_ord <- cut2(HW4$Taxes, m=12)\n\n#Creating cross tabulation, click run!\ntable(HW4$NDIR_dummy,HW4$tax_ord)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   \n    [1535,1853) [1853,2126) [2126,2371) [2371,3655]\n  0           5           4           7          10\n  1           7           8           5           2\n```\n:::\n\n```{.r .cell-code}\n#Creating bar plot, click run!\nbarplot(table(HW4$NDIR_dummy,HW4$tax_ord), beside=TRUE, main= \"The Effect of Tax Brackets on NDIR\", xlab= \"Tax Brackets\", ylab= \"NDIR\", legend = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(table(HW4$NDIR_dummy,HW4$Region), beside=TRUE, main= \"The Effect of Region on NDIR\", xlab= \"Region\", ylab= \"NDIR\", legend = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(table(HW4$tax_ord,HW4$Region), beside=TRUE, main= \"The Effect of Region on Tax Brackets\", xlab= \"Region\", ylab= \"Tax Bracket Prevalence\", legend = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#Code for a Table with Embedded Charts\n#ggplot(df,aes(z,x,fill=as.factor(y)),angle=45,size=16)+ geom_bar(position=\"dodge\",stat=\"identity\") +facet_wrap(~z,nrow=3)\n\n#Creating Table with Embedded Charts, click run!\ndf <- data.frame(HW4) \np <- ggplot(df,aes(tax_ord,NDIR,fill=as.factor(Region)), angle=4, size=5)+ geom_bar(position=\"dodge\",stat=\"identity\") + facet_wrap(~tax_ord,nrow=3) \np + ggtitle(\"The Effect of Tax Brackets on NDIR by Region\") + xlab(\"Tax Brackets\") + ylab(\"NDIR\") + guides(fill=guide_legend(title=\"Region\")) + theme(axis.text.x = element_text(size = 6))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}